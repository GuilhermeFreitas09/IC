---
title: "Relatorio Parcial"
output: html_notebook
---


```{r}
#BiocManager::install("IlluminaHumanMethylationEPICanno.ilm10b4.hg19")
#BiocManager::install("missMethyl")

```

```{r,message=FALSE,warning=FALSE}
library(limma)
library(minfi)
library(IlluminaHumanMethylationEPICmanifest)
library(IlluminaHumanMethylationEPICanno.ilm10b4.hg19)
library(RColorBrewer)
library(readr)
#tidyverse::tidyverse_packages()
```

# Carregando raw_data

```{r}
load("../../dados/rgSetSample.rds")
```

```{r}
dim(rgSet)
```

# Passo a passo do Cross Package

## Banco de dados dados amostrado

```{r}
annEPIC <- getAnnotation(IlluminaHumanMethylationEPICanno.ilm10b4.hg19)
head(annEPIC)
```
46 informações de 865859 ilhas.

```{r}
sampleNames(rgSet)
```
Cada uma dessas amostras apresentam os arquivos green e red

##  p-valor

```{r}
detP <- data.frame(detectionP(rgSet))
head(detP)
```

```{r}
write_csv(detP, "../../dados/pvalor.csv")
```

```{r}
detP = read_csv(file = "../../dados/pvalor.csv")
```

```{r}
barplot(colMeans(detP), las=2, cex.names=0.5, ylim=c(0,0.0006))
abline(h=0.0005,col="red")
```

Legenda do gráfico: Média dos p-valores detectados nas sondas para cada indivíduo.

Médias dos pvalores pequenas. Mas como eles são calculados?

## Normalização

### preprocessQuantile

```{r}
# preprocess quantile
load("../../dados/mSetSq")
```

```{r}
dim(mSetSq)
```

```{r,fig.width=15}
par(mfrow=c(2,1))
densityPlot(rgSet,main="Dados Brutos", legend=FALSE)
densityPlot(getBeta(mSetSq),main="Dados Pré-processados", legend=FALSE)
```

```{r, fig.width=15}
par(mfrow=c(1,2))
boxplot(getBeta(rgSet),main="Dados Brutos", legend=FALSE)
boxplot(getBeta(mSetSq),main="Dados Pré-processados", legend=FALSE)
```

## Multidimensional Scaling

```{r}
plotMDS(getM(mSetSq), top=1000, gene.selection="common")
```







